<% if @settings['auto_calculate_proyects'] %>
  <p>Proyects will be linked based on users. If you want to indicate proyects manually, you may change the plugin configuration</p>
<% else %>
  <div class="splitcontentleft">
    <% if @projects.any? %>
      <div class="generic-table--container">
        <div class="generic-table--results-container">
          <table class="generic-table list projects">
            <colgroup>
              <col highlight-col>
              <col>
            </colgroup>
            <thead>
              <tr>
                <th>
                  <div class="generic-table--header-outer">
                    <div class="generic-table--header">
                      <%= t(:label_project_plural) %>
                    </div>
                  </div>
                </th>
                <th>
                </th>
              </tr>
            </thead>
            <tbody>
              <% @projects.each do |project| %>
                <% next if project.new_record? %>
                <tr id="project-<%= project.id %>" class="<%= cycle 'odd', 'even' %> project">
                  <td class="project"><%= link_to_project project %></td>
                  <td class="buttons">
                    <%=
                      link_to "",
                              delete_project_company_path(id: @company, project_id: project.id),
                              method: :post,
                              title: t(:button_delete),
                              class: 'icon icon-delete'
                    %>
                  </td>
                </tr>
              <% end; reset_cycle %>
            </tbody>
          </table>
        </div>
      </div>
    <% else %>
      <div class="generic-table--container" style="height:150px">
        <div class="generic-table--no-results-container">
          <i class="icon-info1"></i>
          <h2 class="generic-table--no-results-title">
            <%= t(:label_no_data) %>
          </h2>
          <div class="generic-table--no-results-description">
            <p>No projects are associated with this company.</p>
          </div>
        </div>
      </div>
    <% end %>
  </div>

  <div class="splitcontentright">
    <% if @available_projects.any? %>
      <%=
        form_for(
          :project,
          url: { controller: 'companies', action: 'add_projects', id: @company },
          update: 'projects',
          method: :post
        ) do |f|
      %>
        <fieldset>
          <legend><%= t(:label_project_new) %></legend>

          <p><%= label_tag "project_search", l(:label_project_filter), :class => 'filter_label' %>
          <%= text_field_tag 'project_search', nil %></p>
          <%#= observe_field( :project_search, :method => :get, :frequency => 0.5, :update => :available_projects, :url => {:action => "filter_available_projects", :controller=>"companies" , :id => @company }, :with => "q" ) %>
          <div id="available_projects" class="filtered_results">
            <%= render :partial => 'available_projects' %>
          </div>

          <p><%= submit_tag t(:button_add) %></p>
        </fieldset>
      <% end %>
    <% end %>
  </div>
<% end %>
